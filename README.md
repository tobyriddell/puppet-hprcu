puppet-hprcu
============

Puppet type &amp; provider to modify BIOS of HP servers using hprcu

# Usage

<code>puppet resource hprcu</code>

<code>puppet apply -e "hprcu{ 'default': intelrhyperthreadingoptions = 'enabled' }"</code>

In a manifest:

<pre><code>hprcu { 'default':
	intelrhyperthreadingoptions = 'Enabled' 
}</code></pre>

In a class:

<pre><code>
class { 'energysaving':
	hprcu { 'default':
		intelrhyperthreadingoptions => 'Enabled',
	}
}
</code></pre>

Notes: 

* Owing to the fact that there's only one collection of BIOS settings per host, there's only one valid name for the resource: 'default'.
* Property names must conform to the Puppet grammar, as defined in grammar.ra in the Puppet source, they are auto-generated by gen_hprcu_type.rb from XML output by hprcu.

# Design considerations

The ideal situation would be to have a single type for managing BIOS settings on hardware from many different vendors. Corresponding providers would handle getting/setting the type's properties for the different platforms. However, the target is moving: vendors have different names for the same BIOS setting, BIOS revisions change the names, new hardware introduces new settings. 

One option is to map between a common setting, such as C-states enable and a well-defined name, but what to do when there's a setting that's only supported by an HP BIOS and not by an Oracle BIOS, for example? And when the setting's name changes the mappings would need to be updated - another moving target to have to track.

I've chosen to implement a separate type/provider for HP hardware that uses the HP hprcu utility. The code for the type can be regenerated automatically using XML output from hprcu. The provider doesn't contain any code that changes if the property-names change and therefore it shouldn't need to be changed as often.

Because property names are auto-generated they names can be non-intuitive, for example 'intelrhyperthreadingoptions' instead of plain 'hyperthreading'. As mentioned above, I don't want to have to maintain a static mapping. Running 'puppet resource hprcu' on a server is a good way to determine the name of the relevant property.
